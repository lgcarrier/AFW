afw.afw_21.item.choix_aprob={insta:[],obten:function(b){var c;for(var a=0;a<afw.afw_21.item.choix_aprob.insta.length;a++){if(afw.afw_21.item.choix_aprob.insta[a].id==b){c=afw.afw_21.item.choix_aprob.insta[a];break}}return c},suprm:function(b){for(var a=0;a<afw.afw_21.item.choix_aprob.insta.length;a++){if(afw.afw_21.item.choix_aprob.insta[a].id==b){afw.afw_21.item.choix_aprob.insta.splice(a,1);if(afw.jQuery.browser.msie!=undefined&&afw.jQuery.browser.msie&&afw.jQuery.browser.version=="9.0"){myObj=document.getElementById(b).parentNode;myObj.parentNode.removeChild(myObj)}else{afw.jQuery("#"+b).empty().dialog("destroy").remove()}}}},choix_aprob:function(a){var c=this;this.jQuery=afw.jQuery;this.node=false;this.id=false;this.initl=b;this.optio={vva_id:"",vva_titre:"",vnu_evolt_stat:"",vnu_procs_aprob:"",vva_mesg_confr:"",vva_plugn_ajax:"",vva_id_div_mesg:"afw_mesg_apex",vva_clas_custm:"",vnu_largr:640,vnu_hautr:320,vva_clas_dialg:"afw-21-contn-choix-aprob",vva_clas_body:"",vva_clas_fotr:"",vva_role_aprob:"",vob_role_aprob:{}};this.initl(a);return c;function b(d){c.optio=c.jQuery.extend(c.optio,d);c.id=c.optio.vva_id}return c},ouvri_dialg:function(c){var b=afw.afw_21.item.choix_aprob.obten(c.getAttribute("data-choix-aprob-id"));b.optio.vnu_evolt_stat=c.getAttribute("data-choix-aprob-seqnc");b.optio.vva_titre=c.getAttribute("data-choix-aprob-titre");b.optio.vnu_procs_aprob=c.getAttribute("data-procs-aprob");b.optio.vva_mesg_confr=c.getAttribute("data-choix-choix-aprob-mesg");b.optio.vva_role_aprob=c.getAttribute("data-choix-role-aprob");var a=[];if(b.optio.vnu_evolt_stat!=""){a.push({text:b.optio.vva_titre,"class":"btn btn-primary",click:function(){afw.afw_21.item.choix_aprob.chois_aprob(""+b.id)}})}else{if(b.optio.vva_role_aprob!=""){b.optio.vnu_hautr=480}a.push({text:b.optio.vva_titre,"class":"btn btn-primary",click:function(){afw.afw_21.item.choix_aprob.insta_procs_aprob(""+b.id)}})}b.jQuery('<div id="'+b.id+'" class="'+b.optio.vva_clas_dialg+" "+b.optio.vva_clas_custm+'"></div>').dialog({autoOpen:false,title:b.optio.vva_titre,modal:true,resizable:false,closeOnEscape:false,dialogClass:"",draggable:false,width:b.optio.vnu_largr,height:b.optio.vnu_hautr,buttons:a,beforeClose:function(d,e){},close:function(d,e){$("#"+b.id).empty().remove()},create:function(d,e){b.node=document.getElementById(b.id)},open:function(e,f){if(b.optio.vnu_evolt_stat!=""){b.jQuery("#"+b.id).append('<div class="modal-body '+b.optio.vva_clas_body+'"><textarea class="textarea" name="COMNT_CHOIX_APROB" rows="6" cols="60" maxlength="4000" wrap="virtual" id="CHOIX_APROB_COMNT" class="textarea"></textarea></div>')}else{if(b.optio.vva_role_aprob!=""){b.optio.vob_role_aprob=JSON.parse(b.optio.vva_role_aprob);var d="";d='<div class="modal-body '+b.optio.vva_clas_body+'">';for(i=0;i<b.optio.vob_role_aprob.role.length;i++){d+=b.optio.vob_role_aprob.role[i].nom+'<br/><select id="'+b.optio.vob_role_aprob.role[i].seqnc+'" name="'+b.optio.vob_role_aprob.role[i].seqnc+'" class="selectlist role_aprob">';for(j=0;j<b.optio.vob_role_aprob.role[i].aprob.length;j++){d+='<option value="'+b.optio.vob_role_aprob.role[i].aprob[j].seqnc+'">'+b.optio.vob_role_aprob.role[i].aprob[j].nom+"</option>"}d+="</select><br/>"}d+="</div>";b.jQuery("#"+b.id).append(d)}else{if(b.optio.vva_mesg_confr!=""){b.jQuery("#"+b.id).append("<p>"+b.optio.vva_mesg_confr+"</p>")}}}}});b.jQuery("#"+b.id).dialog("open")},fermr_dialg:function(a){var b=afw.afw_21.item.choix_aprob.obten(a);b.jQuery("#"+b.id).dialog("close")},chois_aprob:function(a){var b=afw.afw_21.item.choix_aprob.obten(a);b.jQuery.exec_aplic_procs({plugn_ajax:b.optio.vva_plugn_ajax,widget_action:"CHOIS_APROB",x01:b.optio.vnu_evolt_stat,x02:$("#CHOIX_APROB_COMNT").val(),procs_retrn_data_type:"json",sucs_procs:function(){console.log("success");b.jQuery("#"+b.id).dialog("close");apex.submit({request:"APPLY_CHANGES",showWait:true})},error_procs:function(){console.log("failure");b.jQuery("#"+b.id).dialog("close");apex.submit({request:"APPLY_CHANGES",showWait:true})}})},insta_procs_aprob:function(a){var c=afw.afw_21.item.choix_aprob.obten(a);var b="";if(c.optio.vva_role_aprob!=""){for(i=0;i<c.optio.vob_role_aprob.role.length;i++){b+=c.optio.vob_role_aprob.role[i].seqnc+",";b+=$("select#"+c.optio.vob_role_aprob.role[i].seqnc).val()+":"}}c.jQuery.exec_aplic_procs({plugn_ajax:c.optio.vva_plugn_ajax,widget_action:"INSTA_PROCS_APROB",x01:c.optio.vnu_procs_aprob,x02:b,procs_retrn_data_type:"json",sucs_procs:function(){console.log("success");c.jQuery("#"+c.id).dialog("close");apex.submit({request:"APPLY_CHANGES",showWait:true})},error_procs:function(){console.log("failure");c.jQuery("#"+c.id).dialog("close");apex.submit({request:"APPLY_CHANGES",showWait:true})}})}};