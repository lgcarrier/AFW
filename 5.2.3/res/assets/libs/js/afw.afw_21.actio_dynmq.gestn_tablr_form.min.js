afw.afw_21.actio_dynmq.gestn_tablr_form={initl:function(){},convr_ligne_titre:function(a,k){var m=document.getElementsByTagName("input");var f=null;for(var e=0;e<m.length;e++){f=m[e];if(f.id.match(/^[f][0-9]{2}_[0-9]{4}$/)){if(f.type==a&&f.value==k){var c=f;while(c&&c.tagName.toLowerCase()!="tr"){c=c.parentNode}if(c){var b=c.parentNode;var n=b.insertRow(c.rowIndex+1);for(var d=0;d<c.cells.length;d++){var h=c.cells[d];var g=h.getAttribute("align");if(g==null||g==""){g="left"}var l=document.createElement("th");l.className="t20ReportHeader";l.setAttribute("align",g);l.innerHTML=h.innerHTML;n.appendChild(l)}b.deleteRow(c.rowIndex)}}}}},numrt_apex_item:function(a){var c="00"+a;c=c.substr(c.length-2);var f=document.getElementsByName("f"+c);for(var b=0;b<f.length;b++){var e=f[b];while(e&&e.tagName.toLowerCase()!="tr"){e=e.parentNode}if(e){var d="0000"+(e.rowIndex);d=d.substr(d.length-4);f[b].id="f"+c+"_"+d}}},defnr_indic:function(g,b,f,m,o,j,k,e){var q=document.getElementsByTagName("input");var l=null;if(typeof k=="undefined"){k="auto"}if(typeof e=="undefined"){e=","}for(var h=0;h<q.length;h++){l=q[h];if(l.id.match(/^[f][0-9]{2}_[0-9]{4}$/)){if(l.type==g&&l.value==b){var d="00"+(parseInt(l.id.substr(1,2),10)+f)+"";d=d.substr(d.length-2);var c=l.id.substr(4);var p="f"+d+"_"+c;var a=document.getElementById(p);if(a){if(m){a.style.display="none";var n=a;while(n&&n.tagName.toLowerCase()!="td"&&n.tagName.toLowerCase()!="th"){n=n.parentNode}if(n){n.innerHTML+='<div id="txt_'+p+'">&nbsp;</div>'}}if(o){a.readOnly=true;a.className="afw_itf_desct"}a.afw={};a.afw.nb_decml=k;a.afw.carct_decml=e;if(typeof j!="undefined"&&j!==null){a.afw.x=parseInt(d,10);a.afw.y=parseInt(c,10);a.afw.calcl=j;a.afw.table_champ=new Array();a.afw.num_champ=0;obten_valr_calc(a.afw.calcl,a,true)}else{defnr_evenm_on_chang(a,"formt");formt_champ(a,a.value)}}}}}}};function afw_itf_numrt_apex_item(a){afw.afw_21.actio_dynmq.gestn_tablr_form.numrt_apex_item(a)}function afw_itf_convr_ligne_titre(b,a){afw.afw_21.actio_dynmq.gestn_tablr_form.convr_ligne_titre(b,a)}function afw_itf_defnr_indic(d,h,f,a,c,b,g,e){afw.afw_21.actio_dynmq.gestn_tablr_form.defnr_indic(d,h,f,a,c,b,g,e)}function afw_itf_pret(){reclc_tout()}var g_arr_reclc=new Array();var g_err_refrc_circl_trouve;function defnr_evenm_on_chang(c,b){if(!c.afw){c.afw={}}if(!c.afw.indic_on_chang){c.afw.indic_on_chang={};var a=c.onchange;if(a){c.onchange=function(){a();evenm_on_change(this)}}else{c.onchange=function(){evenm_on_change(this)}}}if(b=="reclc"){c.afw.indic_on_chang.reclc=1}else{if(b=="formt"){c.afw.indic_on_chang.formt=1}}}function evenm_on_change(a){if(a.afw&&a.afw.indic_on_chang){if(a.afw.indic_on_chang.formt==1){formt_champ(a,a.value)}if(a.afw.indic_on_chang.reclc==1){reclc_tout()}}}function obten_valr_champ(a,g){var b="00"+a;b=b.substr(b.length-2);var e="0000"+g;e=e.substr(e.length-4);var d;var c="f"+b+"_"+e;var f=document.getElementById(c);if(f){if(f.afw&&f.afw.calcl){reclc_champ(f);d=f.afw.valeur_num}else{d=parseFloat(f.value.replace(/,/g,".").replace(/ /g,""));if(isNaN(d)){d=0}}defnr_evenm_on_chang(f,"reclc");return d}else{return 0}}function obten_valr_calc(g,k,d){if(typeof(g)=="object"){var h=g[0].toLowerCase();var b=g.length;if(d){if(h=="cell"){var p=(1<b)?obten_valr_calc(g[1],k,d):0;var n=(2<b)?obten_valr_calc(g[2],k,d):0;return obten_valr_champ(k.afw.x+p,k.afw.y+n)}else{for(var f=1;f<b;f++){obten_valr_calc(g[f],k,d)}}return}else{switch(h){case"cell":var p=(1<b)?obten_valr_calc(g[1],k,d):0;var n=(2<b)?obten_valr_calc(g[2],k,d):0;return obten_valr_champ(k.afw.x+p,k.afw.y+n);break;case"+":var m=(1<b)?obten_valr_calc(g[1],k,d):0;for(var f=2;f<b;f++){m+=obten_valr_calc(g[f],k,d)}return m;break;case"-":var m=(1<b)?obten_valr_calc(g[1],k,d):0;for(var f=2;f<b;f++){m-=obten_valr_calc(g[f],k,d)}return m;break;case"*":var m=(1<b)?obten_valr_calc(g[1],k,d):0;for(var f=2;f<b;f++){m*=obten_valr_calc(g[f],k,d)}return m;break;case"/":var m=(1<b)?obten_valr_calc(g[1],k,d):0;for(var f=2;f<b;f++){m/=obten_valr_calc(g[f],k,d)}return m;break;case"somme":var c=(1<b)?obten_valr_calc(g[1],k,d):x_ref;var o=(2<b)?obten_valr_calc(g[2],k,d):y_ref;var a=(3<b)?obten_valr_calc(g[3],k,d):c;var l=(4<b)?obten_valr_calc(g[4],k,d):l;var r=(5<b)?obten_valr_calc(g[5],k,d):1;var q=(6<b)?obten_valr_calc(g[6],k,d):1;var m=0;for(var e=o;e<=l;e+=q){for(var f=c;f<=a;f+=r){m+=obten_valr_champ(k.afw.x+f,k.afw.y+e)}}return m;break;default:return 0;break}}}else{return g}}function instr(b,a){for(i=0;i<b.length;i++){if(a==b.substr(i,1)){return i}}return -1}function formt_champ(h,f){var d;var e=f=f.replace(/,/g,".").replace(/ /g,"");if(h.afw&&(h.afw.nb_decml=="auto"||h.afw.nb_decml==="")){d=""+f}else{var b=parseFloat(e);if(isNaN(b)){b=0}d=b.toFixed(h.afw.nb_decml)}var g=instr(d,".");if(g>=0){var c=d.substr(0,g);var a="";while(c.length>3){a=" "+c.substr(c.length-3,3)+a;c=c.substr(0,c.length-3)}d=c+a+"."+d.substr(g+1)}d=d.replace(/[.]/,h.afw.carct_decml);h.value=d}function reclc_champ(b){var a;if(typeof g_arr_reclc[b.id]!="undefined"){if(g_arr_reclc[b.id]=="."){if(!g_err_refrc_circl_trouve){g_err_refrc_circl_trouve=true;alert("ERREUR: Référence circulaire rencontrée.")}}}else{g_arr_reclc[b.id]=".";b.afw.valeur_num=obten_valr_calc(b.afw.calcl,b,false);a=""+b.afw.valeur_num;formt_champ(b,a);g_arr_reclc[b.id]="!"}}function reclc_tout(){var b=document.getElementsByTagName("input");var c=null;g_arr_reclc=new Array();g_err_refrc_circl_trouve=false;for(var a=0;a<b.length;a++){c=b[a];if(c.afw&&c.afw.calcl){reclc_champ(c)}}};