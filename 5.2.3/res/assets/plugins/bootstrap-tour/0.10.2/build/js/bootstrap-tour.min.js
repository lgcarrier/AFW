(function(d,c){var b,a;a=c.document;b=(function(){function e(f){var h;try{h=c.localStorage}catch(g){h=false}this._options=d.extend({name:"tour",steps:[],container:"body",autoscroll:true,keyboard:true,storage:h,debug:false,backdrop:false,backdropContainer:"body",backdropPadding:0,redirect:true,orphan:false,duration:false,delay:false,basePath:"",template:'<div class="popover" role="tooltip"> <div class="arrow"></div> <h3 class="popover-title"></h3> <div class="popover-content"></div> <div class="popover-navigation"> <div class="btn-group"> <button class="btn btn-sm btn-default" data-role="prev">&laquo; Prev</button> <button class="btn btn-sm btn-default" data-role="next">Next &raquo;</button> <button class="btn btn-sm btn-default" data-role="pause-resume" data-pause-text="Pause" data-resume-text="Resume">Pause</button> </div> <button class="btn btn-sm btn-default" data-role="end">End tour</button> </div> </div>',afterSetState:function(i,j){},afterGetState:function(i,j){},afterRemoveState:function(i){},onStart:function(i){},onEnd:function(i){},onShow:function(i){},onShown:function(i){},onHide:function(i){},onHidden:function(i){},onNext:function(i){},onPrev:function(i){},onPause:function(j,i){},onResume:function(j,i){},onRedirectError:function(i){}},f);this._force=false;this._inited=false;this._current=null;this.backdrop={overlay:null,$element:null,$background:null,backgroundShown:false,overlayElementShown:false};this}e.prototype.addSteps=function(g){var h,i,f;for(i=0,f=g.length;i<f;i++){h=g[i];this.addStep(h)}return this};e.prototype.addStep=function(f){this._options.steps.push(f);return this};e.prototype.getStep=function(f){if(this._options.steps[f]!=null){return d.extend({id:"step-"+f,path:"",host:"",placement:"right",title:"",content:"<p></p>",next:f===this._options.steps.length-1?-1:f+1,prev:f-1,animation:true,container:this._options.container,autoscroll:this._options.autoscroll,backdrop:this._options.backdrop,backdropContainer:this._options.backdropContainer,backdropPadding:this._options.backdropPadding,redirect:this._options.redirect,reflexElement:this._options.steps[f].element,orphan:this._options.orphan,duration:this._options.duration,delay:this._options.delay,template:this._options.template,onShow:this._options.onShow,onShown:this._options.onShown,onHide:this._options.onHide,onHidden:this._options.onHidden,onNext:this._options.onNext,onPrev:this._options.onPrev,onPause:this._options.onPause,onResume:this._options.onResume,onRedirectError:this._options.onRedirectError},this._options.steps[f])}};e.prototype.init=function(f){this._force=f;if(this.ended()){this._debug("Tour ended, init prevented.");return this}this.setCurrentStep();this._initMouseNavigation();this._initKeyboardNavigation();this._onResize((function(g){return function(){return g.showStep(g._current)}})(this));if(this._current!==null){this.showStep(this._current)}this._inited=true;return this};e.prototype.start=function(f){var g;if(f==null){f=false}if(!this._inited){this.init(f)}if(this._current===null){g=this._makePromise(this._options.onStart!=null?this._options.onStart(this):void 0);this._callOnPromiseDone(g,this.showStep,0)}return this};e.prototype.next=function(){var f;f=this.hideStep(this._current);return this._callOnPromiseDone(f,this._showNextStep)};e.prototype.prev=function(){var f;f=this.hideStep(this._current);return this._callOnPromiseDone(f,this._showPrevStep)};e.prototype.goTo=function(f){var g;g=this.hideStep(this._current);return this._callOnPromiseDone(g,this.showStep,f)};e.prototype.end=function(){var f,g;f=(function(h){return function(i){d(a).off("click.tour-"+h._options.name);d(a).off("keyup.tour-"+h._options.name);d(c).off("resize.tour-"+h._options.name);h._setState("end","yes");h._inited=false;h._force=false;h._clearTimer();if(h._options.onEnd!=null){return h._options.onEnd(h)}}})(this);g=this.hideStep(this._current);return this._callOnPromiseDone(g,f)};e.prototype.ended=function(){return !this._force&&!!this._getState("end")};e.prototype.restart=function(){this._removeState("current_step");this._removeState("end");this._removeState("redirect_to");return this.start()};e.prototype.pause=function(){var f;f=this.getStep(this._current);if(!(f&&f.duration)){return this}this._paused=true;this._duration-=new Date().getTime()-this._start;c.clearTimeout(this._timer);this._debug("Paused/Stopped step "+(this._current+1)+" timer ("+this._duration+" remaining).");if(f.onPause!=null){return f.onPause(this,this._duration)}};e.prototype.resume=function(){var f;f=this.getStep(this._current);if(!(f&&f.duration)){return this}this._paused=false;this._start=new Date().getTime();this._duration=this._duration||f.duration;this._timer=c.setTimeout((function(g){return function(){if(g._isLast()){return g.next()}else{return g.end()}}})(this),this._duration);this._debug("Started step "+(this._current+1)+" timer with duration "+this._duration);if((f.onResume!=null)&&this._duration!==f.duration){return f.onResume(this,this._duration)}};e.prototype.hideStep=function(g){var f,j,h;h=this.getStep(g);if(!h){return}this._clearTimer();j=this._makePromise(h.onHide!=null?h.onHide(this,g):void 0);f=(function(i){return function(l){var k;k=d(h.element);if(!(k.data("bs.popover")||k.data("popover"))){k=d("body")}k.popover("destroy").removeClass("tour-"+i._options.name+"-element tour-"+i._options.name+"-"+g+"-element");if(h.reflex){d(h.reflexElement).removeClass("tour-step-element-reflex").off(""+(i._reflexEvent(h.reflex))+".tour-"+i._options.name)}if(h.backdrop){i._hideBackdrop()}if(h.onHidden!=null){return h.onHidden(i)}}})(this);this._callOnPromiseDone(j,f);return j};e.prototype.showStep=function(f){var k,j,h,g;if(this.ended()){this._debug("Tour ended, showStep prevented.");return this}g=this.getStep(f);if(!g){return}h=f<this._current;k=this._makePromise(g.onShow!=null?g.onShow(this,f):void 0);j=(function(i){return function(n){var m,l;i.setCurrentStep(f);m=(function(){switch({}.toString.call(g.path)){case"[object Function]":return g.path();case"[object String]":return this._options.basePath+g.path;default:return g.path}}).call(i);if(i._isRedirect(g.host,m,a.location)){i._redirect(g,f,m);if(!i._isJustPathHashDifferent(g.host,m,a.location)){return}}if(i._isOrphan(g)){if(g.orphan===false){i._debug("Skip the orphan step "+(i._current+1)+".\nOrphan option is false and the element does not exist or is hidden.");if(h){i._showPrevStep()}else{i._showNextStep()}return}i._debug("Show the orphan step "+(i._current+1)+". Orphans option is true.")}if(g.backdrop){i._showBackdrop(g)}l=function(){if(i.getCurrentStep()!==f){return}if((g.element!=null)&&g.backdrop){i._showOverlayElement(g)}i._showPopover(g,f);if(g.onShown!=null){g.onShown(i)}return i._debug("Step "+(i._current+1)+" of "+i._options.steps.length)};if(g.autoscroll){i._scrollIntoView(g.element,l)}else{l()}if(g.duration){return i.resume()}}})(this);if(g.delay){this._debug("Wait "+g.delay+" milliseconds to show the step "+(this._current+1));c.setTimeout((function(i){return function(){return i._callOnPromiseDone(k,j)}})(this),g.delay)}else{this._callOnPromiseDone(k,j)}return k};e.prototype.getCurrentStep=function(){return this._current};e.prototype.setCurrentStep=function(f){if(f!=null){this._current=f;this._setState("current_step",f)}else{this._current=this._getState("current_step");this._current=this._current===null?null:parseInt(this._current,10)}return this};e.prototype._setState=function(f,h){var i,g;if(this._options.storage){g=""+this._options.name+"_"+f;try{this._options.storage.setItem(g,h)}catch(j){i=j;if(i.code===DOMException.QUOTA_EXCEEDED_ERR){this._debug("LocalStorage quota exceeded. State storage failed.")}}return this._options.afterSetState(g,h)}else{if(this._state==null){this._state={}}return this._state[f]=h}};e.prototype._removeState=function(f){var g;if(this._options.storage){g=""+this._options.name+"_"+f;this._options.storage.removeItem(g);return this._options.afterRemoveState(g)}else{if(this._state!=null){return delete this._state[f]}}};e.prototype._getState=function(f){var g,h;if(this._options.storage){g=""+this._options.name+"_"+f;h=this._options.storage.getItem(g)}else{if(this._state!=null){h=this._state[f]}}if(h===void 0||h==="null"){h=null}this._options.afterGetState(f,h);return h};e.prototype._showNextStep=function(){var h,f,g;g=this.getStep(this._current);f=(function(i){return function(j){return i.showStep(g.next)}})(this);h=this._makePromise(g.onNext!=null?g.onNext(this):void 0);return this._callOnPromiseDone(h,f)};e.prototype._showPrevStep=function(){var h,f,g;g=this.getStep(this._current);f=(function(i){return function(j){return i.showStep(g.prev)}})(this);h=this._makePromise(g.onPrev!=null?g.onPrev(this):void 0);return this._callOnPromiseDone(h,f)};e.prototype._debug=function(f){if(this._options.debug){return c.console.log("Bootstrap Tour '"+this._options.name+"' | "+f)}};e.prototype._isRedirect=function(h,i,f){var g;if(h!==""){if(this._isHostDifferent(h,f.href)){return true}}g=[f.pathname,f.search,f.hash].join("");return(i!=null)&&i!==""&&(({}.toString.call(i)==="[object RegExp]"&&!i.test(g))||({}.toString.call(i)==="[object String]"&&this._isPathDifferent(i,g)))};e.prototype._isHostDifferent=function(f,g){return this._getProtocol(f)!==this._getProtocol(g)||this._getHost(f)!==this._getHost(g)};e.prototype._isPathDifferent=function(g,f){return this._getPath(g)!==this._getPath(f)||!this._equal(this._getQuery(g),this._getQuery(f))||!this._equal(this._getHash(g),this._getHash(f))};e.prototype._isJustPathHashDifferent=function(h,i,f){var g;if(h!==""){if(this._isHostDifferent(h,f.href)){return false}}g=[f.pathname,f.search,f.hash].join("");if({}.toString.call(i)==="[object String]"){return this._getPath(i)===this._getPath(g)&&this._equal(this._getQuery(i),this._getQuery(g))&&!this._equal(this._getHash(i),this._getHash(g))}return false};e.prototype._redirect=function(g,f,h){if(d.isFunction(g.redirect)){return g.redirect.call(this,h)}else{if(g.redirect===true){this._debug("Redirect to "+g.host+h);if(this._getState("redirect_to")===(""+f)){this._debug("Error redirection loop to "+h);this._removeState("redirect_to");if(g.onRedirectError!=null){return g.onRedirectError(this)}}else{this._setState("redirect_to",""+f);return a.location.href=""+g.host+h}}}};e.prototype._isOrphan=function(f){return(f.element==null)||!d(f.element).length||d(f.element).is(":hidden")&&(d(f.element)[0].namespaceURI!=="http://www.w3.org/2000/svg")};e.prototype._isLast=function(){return this._current<this._options.steps.length-1};e.prototype._showPopover=function(k,j){var f,l,g,h;d(".tour-"+this._options.name).remove();h=d.extend({},this._options);g=this._isOrphan(k);k.template=this._template(k,j);if(g){k.element="body";k.placement="top"}f=d(k.element);f.addClass("tour-"+this._options.name+"-element tour-"+this._options.name+"-"+j+"-element");if(k.options){d.extend(h,k.options)}if(k.reflex&&!g){d(k.reflexElement).addClass("tour-step-element-reflex").off(""+(this._reflexEvent(k.reflex))+".tour-"+this._options.name).on(""+(this._reflexEvent(k.reflex))+".tour-"+this._options.name,(function(i){return function(){if(i._isLast()){return i.next()}else{return i.end()}}})(this))}f.popover({placement:k.placement,trigger:"manual",title:k.title,content:k.content,html:true,animation:k.animation,container:k.container,template:k.template,selector:k.element}).popover("show");l=f.data("bs.popover")?f.data("bs.popover").tip():f.data("popover").tip();l.attr("id",k.id);this._reposition(l,k);if(g){return this._center(l)}};e.prototype._template=function(l,j){var n,f,g,m,h,k;k=l.template;if(this._isOrphan(l)&&{}.toString.call(l.orphan)!=="[object Boolean]"){k=l.orphan}h=d.isFunction(k)?d(k(j,l)):d(k);n=h.find(".popover-navigation");g=n.find('[data-role="prev"]');f=n.find('[data-role="next"]');m=n.find('[data-role="pause-resume"]');if(this._isOrphan(l)){h.addClass("orphan")}h.addClass("tour-"+this._options.name+" tour-"+this._options.name+"-"+j);if(l.reflex){h.addClass("tour-"+this._options.name+"-reflex")}if(l.prev<0){g.addClass("disabled")}if(l.next<0){f.addClass("disabled")}if(!l.duration){m.remove()}return h.clone().wrap("<div>").parent().html()};e.prototype._reflexEvent=function(f){if({}.toString.call(f)==="[object Boolean]"){return"click"}else{return f}};e.prototype._reposition=function(j,g){var h,f,i,m,n,l,k;m=j[0].offsetWidth;f=j[0].offsetHeight;k=j.offset();n=k.left;l=k.top;h=d(a).outerHeight()-k.top-j.outerHeight();if(h<0){k.top=k.top+h}i=d("html").outerWidth()-k.left-j.outerWidth();if(i<0){k.left=k.left+i}if(k.top<0){k.top=0}if(k.left<0){k.left=0}j.offset(k);if(g.placement==="bottom"||g.placement==="top"){if(n!==k.left){return this._replaceArrow(j,(k.left-n)*2,m,"left")}}else{if(l!==k.top){return this._replaceArrow(j,(k.top-l)*2,f,"top")}}};e.prototype._center=function(f){return f.css("top",d(c).outerHeight()/2-f.outerHeight()/2)};e.prototype._replaceArrow=function(h,i,g,f){return h.find(".arrow").css(f,i?50*(1-i/g)+"%":"")};e.prototype._scrollIntoView=function(h,m){var g,k,f,i,j,l;g=d(h);if(!g.length){return m()}k=d(c);i=g.offset().top;l=k.height();j=Math.max(0,i-(l/2));this._debug("Scroll into view. ScrollTop: "+j+". Element offset: "+i+". Window height: "+l+".");f=0;return d("body, html").stop(true,true).animate({scrollTop:Math.ceil(j)},(function(n){return function(){if(++f===2){m();return n._debug("Scroll into view.\nAnimation end element offset: "+(g.offset().top)+".\nWindow height: "+(k.height())+".")}}})(this))};e.prototype._onResize=function(g,f){return d(c).on("resize.tour-"+this._options.name,function(){clearTimeout(f);return f=setTimeout(g,100)})};e.prototype._initMouseNavigation=function(){var f;f=this;return d(a).off("click.tour-"+this._options.name,".popover.tour-"+this._options.name+" *[data-role='prev']").off("click.tour-"+this._options.name,".popover.tour-"+this._options.name+" *[data-role='next']").off("click.tour-"+this._options.name,".popover.tour-"+this._options.name+" *[data-role='end']").off("click.tour-"+this._options.name,".popover.tour-"+this._options.name+" *[data-role='pause-resume']").on("click.tour-"+this._options.name,".popover.tour-"+this._options.name+" *[data-role='next']",(function(g){return function(h){h.preventDefault();return g.next()}})(this)).on("click.tour-"+this._options.name,".popover.tour-"+this._options.name+" *[data-role='prev']",(function(g){return function(h){h.preventDefault();return g.prev()}})(this)).on("click.tour-"+this._options.name,".popover.tour-"+this._options.name+" *[data-role='end']",(function(g){return function(h){h.preventDefault();return g.end()}})(this)).on("click.tour-"+this._options.name,".popover.tour-"+this._options.name+" *[data-role='pause-resume']",function(h){var g;h.preventDefault();g=d(this);g.text(f._paused?g.data("pause-text"):g.data("resume-text"));if(f._paused){return f.resume()}else{return f.pause()}})};e.prototype._initKeyboardNavigation=function(){if(!this._options.keyboard){return}return d(a).on("keyup.tour-"+this._options.name,(function(f){return function(g){if(!g.which){return}switch(g.which){case 39:g.preventDefault();if(f._isLast()){return f.next()}else{return f.end()}break;case 37:g.preventDefault();if(f._current>0){return f.prev()}break;case 27:g.preventDefault();return f.end()}}})(this))};e.prototype._makePromise=function(f){if(f&&d.isFunction(f.then)){return f}else{return null}};e.prototype._callOnPromiseDone=function(h,g,f){if(h){return h.then((function(i){return function(j){return g.call(i,f)}})(this))}else{return g.call(this,f)}};e.prototype._showBackdrop=function(f){if(this.backdrop.backgroundShown){return}this.backdrop=d("<div>",{"class":"tour-backdrop"});this.backdrop.backgroundShown=true;return d(f.backdropContainer).append(this.backdrop)};e.prototype._hideBackdrop=function(){this._hideOverlayElement();return this._hideBackground()};e.prototype._hideBackground=function(){if(this.backdrop){this.backdrop.remove();this.backdrop.overlay=null;return this.backdrop.backgroundShown=false}};e.prototype._showOverlayElement=function(h){var f,g;f=d(h.element);if(!f||f.length===0){return}if(!this.backdrop.overlayElementShown){this.backdrop.$element=f.addClass("tour-step-backdrop");this.backdrop.$background=d("<div>",{"class":"tour-step-background"});this.backdrop.$background.appendTo(h.backdropContainer);this.backdrop.overlayElementShown=true}g={width:f.innerWidth(),height:f.innerHeight(),offset:f.offset()};if(h.backdropPadding){g=this._applyBackdropPadding(h.backdropPadding,g)}return this.backdrop.$background.width(g.width).height(g.height).offset(g.offset)};e.prototype._hideOverlayElement=function(){if(!this.backdrop.overlayElementShown){return}this.backdrop.$element.removeClass("tour-step-backdrop");this.backdrop.$background.remove();this.backdrop.$element=null;this.backdrop.$background=null;return this.backdrop.overlayElementShown=false};e.prototype._applyBackdropPadding=function(g,f){if(typeof g==="object"){if(g.top==null){g.top=0}if(g.right==null){g.right=0}if(g.bottom==null){g.bottom=0}if(g.left==null){g.left=0}f.offset.top=f.offset.top-g.top;f.offset.left=f.offset.left-g.left;f.width=f.width+g.left+g.right;f.height=f.height+g.top+g.bottom}else{f.offset.top=f.offset.top-g;f.offset.left=f.offset.left-g;f.width=f.width+(g*2);f.height=f.height+(g*2)}return f};e.prototype._clearTimer=function(){c.clearTimeout(this._timer);this._timer=null;return this._duration=null};e.prototype._getProtocol=function(f){f=f.split("://");if(f.length>1){return f[0]}else{return"http"}};e.prototype._getHost=function(f){f=f.split("//");f=f.length>1?f[1]:f[0];return f.split("/")[0]};e.prototype._getPath=function(f){return f.replace(/\/?$/,"").split("?")[0].split("#")[0]};e.prototype._getQuery=function(f){return this._getParams(f,"?")};e.prototype._getHash=function(f){return this._getParams(f,"#")};e.prototype._getParams=function(i,l){var k,j,h,g,f;j=i.split(l);if(j.length===1){return{}}j=j[1].split("&");h={};for(g=0,f=j.length;g<f;g++){k=j[g];k=k.split("=");h[k[0]]=k[1]||""}return h};e.prototype._equal=function(i,h){var g,f;if({}.toString.call(i)==="[object Object]"&&{}.toString.call(h)==="[object Object]"){for(g in i){f=i[g];if(h[g]!==f){return false}}for(g in h){f=h[g];if(i[g]!==f){return false}}return true}return i===h};return e})();return c.Tour=b})(jQuery,window);