if(!window.console){window.console=new function(){this.log=function(a){};this.debug=function(a){};this.error=function(a){}}}if(!window.console.debug||!window.console.error||!window.console.log){window.console=new function(){this.log=function(a){};this.debug=function(a){};this.error=function(a){}}}$.fn.bringToFront=function(a){var b=10;var c=a?$(a):$("*");c.each(function(){if($(this).css("position")!="static"){var d=parseInt($(this).css("zIndex"));b=d>b?parseInt($(this).css("zIndex")):b}});return $(this).css("zIndex",b+=10)};function nearBestPosition(a,f,d){var b=a;var k=f;if(typeof a!="object"){b=$("#"+a)}if(typeof f!="object"){k=$("#"+f)}if(b){k.css("visibility","hidden");var c=false;k.parents().each(function(){if($(this).css("position")=="static"){return}c=true});var l=c?b.position().left:b.offset().left;var j=c?b.position().top:b.offset().top;var i=b.outerHeight();var g=parseFloat(i);if(d){var p=parseFloat(b.outerWidth());var n=parseFloat(k.outerWidth());l+=(p-n)/2}j+=parseFloat(g);var e=l;var m=j;var o=($.browser.msie)?45:35;var q=($.browser.msie)?20:0;if(l&&j){k.css("left",e);k.css("top",m)}if(k.offset().left>=($(window).width()-k.outerWidth())){e=($(window).width()-k.outerWidth()-q)+"px";k.css("left",e)}if(k.offset().left<0){e=0+"px";k.css("left",e)}if((k.offset().top+k.outerHeight()>=(($(window).height()-o)))&&(k.outerHeight()<$(window).height())){k.css("margin-top",(-(b.outerHeight()+k.outerHeight()))+"px")}k.css("visibility","visible")}}String.prototype.trim=function(){return this.replace(/^\s*(\S*(\s+\S+)*)\s*$/,"$1")};String.prototype.startsWith=function(b,a){if(!a){return(b==this.substring(0,b.length))}else{return(b.toLowerCase()==this.substring(0,b.length).toLowerCase())}};String.prototype.endsWith=function(b,a){if(!a){return(b==this.substring(this.length-b.length))}else{return(b.toLowerCase()==this.substring(this.length-b.length).toLowerCase())}};String.prototype.asId=function(){return this.replace(/[^a-zA-Z0-9_]+/g,"")};String.prototype.replaceAll=function(b,a){return this.replace(new RegExp(RegExp.quote(b),"g"),a)};if(!Array.prototype.indexOf){Array.prototype.indexOf=function(c,e){if(this==null){throw new TypeError()}var d=Object(this);var a=d.length>>>0;if(a===0){return -1}var f=0;if(arguments.length>0){f=Number(arguments[1]);if(f!=f){f=0}else{if(f!=0&&f!=Infinity&&f!=-Infinity){f=(f>0||-1)*Math.floor(Math.abs(f))}}}if(f>=a){return -1}var b=f>=0?f:Math.max(a-Math.abs(f),0);for(;b<a;b++){if(b in d&&d[b]===c){return b}}return -1}}Object.size=function(c){var b=0,a;for(a in c){if(c.hasOwnProperty(a)){b++}}return b};function transformToPrintable(b){for(var c in b){var a=b[c];if(typeof(a)=="string"){b[c]=(a+"").replace(/\n/g,"<br>")}}return b}function isValidURL(b){var a=/^(([\w]+:)?\/\/)?(([\d\w]|%[a-fA-f\d]{2,2})+(:([\d\w]|%[a-fA-f\d]{2,2})+)?@)?([\d\w][-\d\w]{0,253}[\d\w]\.)+[\w]{2,4}(:[\d]+)?(\/([-+_~.\d\w]|%[a-fA-f\d]{2,2})*)*(\?(&?([-+_~.\d\w]|%[a-fA-f\d]{2,2})=?)*)?(#([-+_~.\d\w]|%[a-fA-f\d]{2,2})*)?$/;return a.test(b)}function isValidEmail(b){var a=/^((([a-z]|[0-9]|!|#|$|%|&|'|\*|\+|\-|\/|=|\?|\^|_|`|\{|\||\}|~)+(\.([a-z]|[0-9]|!|#|$|%|&|'|\*|\+|\-|\/|=|\?|\^|_|`|\{|\||\}|~)+)*)@((((([a-z]|[0-9])([a-z]|[0-9]|\-){0,61}([a-z]|[0-9])\.))*([a-z]|[0-9])([a-z]|[0-9]|\-){0,61}([a-z]|[0-9])\.)[\w]{2,4}|(((([0-9]){1,3}\.){3}([0-9]){1,3}))|(\[((([0-9]){1,3}\.){3}([0-9]){1,3})\])))$/;return a.test(b)}function isValidInteger(a){reg=new RegExp("^[-+]{0,1}[0-9]*$");return reg.test(a)}function isValidDouble(b){var a=Number.decimalSeparator;reg=new RegExp("^[-+]{0,1}[0-9]*["+a+"]{0,1}[0-9]*$");return reg.test(b)}function isValidTime(a){return !isNaN(millisFromHourMinute(a))}function isValidDurationDays(a){return !isNaN(daysFromString(a))}function isValidDurationMillis(a){return !isNaN(millisFromString(a))}function isValidDurationMillis(a){return !isNaN(millisFromString(a))}function isValidCurrency(j){var e="";var g=Number.currencyFormat+"";var k=false;var b=false;var f="";var c="[0-9\\"+Number.groupingSeparator+"]+[\\"+Number.decimalSeparator+"]?[0-9]*";for(var d=0;d<g.length;d++){var a=g.charAt(d);if(a=="."||a==","||a=="0"){if(f!=""){e=e+"(?:"+RegExp.quote(f)+")?";f=""}}else{if(a=="#"){if(f!=""){e=e+"(?:"+RegExp.quote(f)+")?";f=""}if(!b){b=true;e=e+c}}else{if(a=="-"){if(f!=""){e=e+"(?:"+RegExp.quote(f)+")?";f=""}if(!k){k=true;e=e+"[-]?"}}else{f=f+a}}}}if(!k){e="[-]?"+e}if(f!=""){e=e+"(?:"+RegExp.quote(f)+")?"}e="^"+e+"$";var h=new RegExp(e);return h.test(j)}function getCurrencyValue(a){if(!isValidCurrency(a)){return NaN}return parseFloat(a.replaceAll(Number.groupingSeparator,"").replaceAll(Number.decimalSeparator,".").replace(/[^0123456789.]/,""))}function formatCurrency(a){return formatNumber(a,Number.currencyFormat)}function formatNumber(a,A){if(!A){A="##0.00"}var w=Number.decimalSeparator;var m=Number.groupingSeparator;var b=Number.minusSign;var E=true;var n="0#-,.";var y="";var j=false;for(var z=0;z<A.length;z++){if(n.indexOf(A.charAt(z))==-1){y=y+A.charAt(z)}else{if(z==0&&A.charAt(z)=="-"){j=true}else{break}}}var d="";for(var z=A.length-1;z>=0;z--){if(n.indexOf(A.charAt(z))==-1){d=A.charAt(z)+d}else{break}}A=A.substring(y.length);A=A.substring(0,A.length-d.length);var c=new Number(a);var r=false;if(isNaN(c)){c=0;r=true}if(d=="%"){c=c*100}var s="";if(A.indexOf(".")>-1){var x=w;var k=A.substring(A.lastIndexOf(".")+1);if(E){c=new Number(c.toFixed(k.length))}else{var D=c.toString();D=D.substring(0,D.lastIndexOf(".")+k.length+1);c=new Number(D)}var q=c%1;var t=new String(q.toFixed(k.length));t=t.substring(t.lastIndexOf(".")+1);for(var z=0;z<k.length;z++){if(k.charAt(z)=="#"&&t.charAt(z)!="0"){x+=t.charAt(z)}else{if(k.charAt(z)=="#"&&t.charAt(z)=="0"){var g=t.substring(z);if(g.match("[1-9]")){x+=t.charAt(z)}else{break}}else{if(k.charAt(z)=="0"){x+=t.charAt(z)}}}}s+=x}else{c=Math.round(c)}var l=Math.floor(c);if(c<0){l=Math.ceil(c)}var v="";if(A.indexOf(".")==-1){v=A}else{v=A.substring(0,A.indexOf("."))}var C="";if(!(l==0&&v.substr(v.length-1)=="#")||r){var o=new String(Math.abs(l));var f=9999;if(v.lastIndexOf(",")!=-1){f=v.length-v.lastIndexOf(",")-1}var e=0;for(var z=o.length-1;z>-1;z--){C=o.charAt(z)+C;e++;if(e==f&&z!=0){C=m+C;e=0}}if(v.length>C.length){var B=v.indexOf("0");if(B!=-1){var u=v.length-B;var h=v.length-C.length-1;while(C.length<u){var p=v.charAt(h);if(p==","){p=m}C=p+C;h--}}}}if(!C&&v.indexOf("0",v.length-1)!==-1){C="0"}s=C+s;if(c<0&&j&&y.length>0){y=b+y}else{if(c<0){s=b+s}}if(s.lastIndexOf(w)==s.length-1){s=s.substring(0,s.length-1)}s=y+s+d;return s}RegExp.quote=function(a){return a.replace(/([.?*+^$[\]\\(){}-])/g,"\\$1")};function pad(c,a,b){if((c+"").length<a){return new Array(a-(""+c).length+1).join(b)+c}else{return c}}function getMillisInHours(b){if(!b){return""}var c=b>=0?1:-1;var a=Math.floor(b/3600000);return(c>0?"":"-")+pad(a,2,"0")}function getMillisInHoursMinutes(c){if(typeof(c)!="number"){return""}var d=c>=0?1:-1;c=Math.abs(c);var a=Math.floor(c/3600000);var b=Math.floor((c%3600000)/60000);return(d>0?"":"-")+pad(a,1,"0")+":"+pad(b,2,"0")}function getMillisInDaysHoursMinutes(c){if(!c){return""}var d=c>=0?1:-1;c=Math.abs(c);var e=Math.floor(c/millisInWorkingDay);var a=Math.floor((c%millisInWorkingDay)/3600000);var b=Math.floor((c-e*millisInWorkingDay-a*3600000)/60000);return(d>=0?"":"-")+(e>0?e+"  ":"")+pad(a,1,"0")+":"+pad(b,2,"0")}function millisFromHourMinute(c){var a=0;c.replace(",",".");var f=c.indexOf(":");var e=c.indexOf(".");if(f<0&&e<0&&c.length>5){return parseInt(c,10)}else{if(e>-1){var h=parseFloat(c);a=h*3600000}else{var b=0;var g=0;if(f==-1){b=parseInt(c,10)}else{b=parseInt(c.substring(0,f),10);g=parseInt(c.substring(f+1),10)}a=b*3600000+g*60000}if(typeof(a)!="number"){a=NaN}return a}}function millisFromString(h,a){if(!h){return 0}var k=new RegExp("(\\d+[Yy])|(\\d+[M])|(\\d+[Ww])|(\\d+[Dd])|(\\d+[Hh])|(\\d+[m])|(\\d+[Ss])|(\\d+:\\d+)|(:\\d+)|(\\d*[\\.,]\\d+)|(\\d+)","g");var g=k.exec(h);var d=0;if(!g){return NaN}while(g!=null){for(var c=1;c<g.length;c++){var f=g[c];if(f){var b=0;try{b=parseInt(f)}catch(j){}if(c==1){d=d+b*(a?millisInWorkingDay*workingDaysPerWeek*52:3600000*24*365)}else{if(c==2){d=d+b*(a?millisInWorkingDay*workingDaysPerWeek*4:3600000*24*30)}else{if(c==3){d=d+b*(a?millisInWorkingDay*workingDaysPerWeek:3600000*24*7)}else{if(c==4){d=d+b*(a?millisInWorkingDay:3600000*24)}else{if(c==5){d=d+b*3600000}else{if(c==6){d=d+b*60000}else{if(c==7){d=d+b*1000}else{if(c==8){d=d+millisFromHourMinute(f)}else{if(c==9){d=d+millisFromHourMinute(f)}else{if(c==10){d=d+millisFromHourMinute(f)}else{if(c==11){d=d+b*3600000}}}}}}}}}}}}}g=k.exec(h)}return d}function daysFromString(h,a){if(!h){return undefined}var k=new RegExp("(\\d+[Yy])|(\\d+[Mm])|(\\d+[Ww])|(\\d+[Dd])|(\\d*[\\.,]\\d+)|(\\d+)","g");var g=k.exec(h);var b=0;if(!g){return NaN}while(g!=null){for(var d=1;d<g.length;d++){var f=g[d];if(f){var c=0;try{c=parseInt(f)}catch(j){}if(d==1){b=b+c*(a?workingDaysPerWeek*52:365)}else{if(d==2){b=b+c*(a?workingDaysPerWeek*4:30)}else{if(d==3){b=b+c*(a?workingDaysPerWeek:7)}else{if(d==4){b=b+c}else{if(d==5){b=b+c}else{if(d==6){b=b+c}}}}}}}}g=k.exec(h)}return b}function stopBubble(a){if($.browser.msie&&event){event.cancelBubble=true;event.returnValue=false}else{if(a){a.stopPropagation();a.preventDefault()}}return false}function validateField(c){var b=$(this);var e=true;b.clearErrorAlert();var d=b.val();if(d){var a=b.attr("entryType").toUpperCase();if(a=="INTEGER"){e=isValidInteger(d)}else{if(a=="DOUBLE"){e=isValidDouble(d)}else{if(a=="PERCENTILE"){e=isValidDouble(d)}else{if(a=="URL"){e=isValidURL(d)}else{if(a=="EMAIL"){e=isValidEmail(d)}else{if(a=="DURATIONMILLIS"){e=isValidDurationMillis(d)}else{if(a=="DURATIONDAYS"){e=isValidDurationDays(d)}else{if(a=="DATE"){e=Date.isValid(d,b.attr("format"))}else{if(a=="TIME"){e=isValidTime(d)}else{if(a=="CURRENCY"){e=isValidCurrency(d)}}}}}}}}}}if(!e){b.createErrorAlert(i18n.ERROR_ON_FIELD,i18n.INVALID_DATA)}}return e}jQuery.fn.clearErrorAlert=function(){this.each(function(){var a=$(this);a.removeAttr("invalid").removeClass("formElementsError");$("#"+a.attr("id")+"error").remove()});return this};jQuery.fn.createErrorAlert=function(b,a){this.each(function(){var c=$(this);c.attr("invalid","true").addClass("formElementsError");if($("#"+c.attr("id")+"error").size()<=0){var e=(b?b:"")+": "+(a?a:"");var d="<img width='17' heigh='17' id=\""+c.attr("id")+"error\" error='1'";d+=" onclick=\"alert($(this).attr('title'))\" border='0' align='absmiddle'>";d=$(d);d.attr("title",e).attr("src","res/alert.gif");c.after(d)}});return this};function jsonErrorHandling(a){if(!a.ok){if(a.message){alert("ERROR:\n"+a.message)}for(var b in a.clientEntryErrors){var c=a.clientEntryErrors[b];$(":input[name="+c.name+"]").createErrorAlert(c.error)}}}jQuery.fn.updateOldValue=function(){this.each(function(){var a=$(this);a.data("_oldvalue",a.val())});return this};jQuery.fn.isValueChanged=function(){var a=false;this.each(function(){var b=$(this);if(b.val()+""!=b.data("_oldvalue")+""){a=true;return false}});return a};jQuery.fn.getOldValue=function(){return $(this).data("_oldvalue")};$.fn.unselectable=function(){this.each(function(){$(this).addClass("unselectable").attr("unselectable","on")});return $(this)};$.fn.clearUnselectable=function(){this.each(function(){$(this).removeClass("unselectable").removeAttr("unselectable")});return $(this)};var __profiler={};function Profiler(a){this.startTime=new Date().getTime();this.name=a;this.stop=function(){if(!__profiler[this.name]){__profiler[this.name]={millis:0,count:0}}__profiler[this.name].millis+=new Date().getTime()-this.startTime;__profiler[this.name].count++};this.display=function(){console.debug(__profiler[this.name])};this.reset=function(){delete __profiler[this.name]}}Profiler.reset=function(){__profiler={}};Profiler.displayAll=function(){var b="";var a=0;for(var d in __profiler){var e=__profiler[d];var c="                          ".substr(0,30-d.length);b+=d+c+"\t millis:"+e.millis+"\t count:"+e.count+"\n";a+=e.millis}console.debug(b)};$(document).ready(function(){$(":input[oldValue]").livequery(function(){$(this).updateOldValue()});$(".validated").livequery("blur",validateField)});function openBlackPopup(d,f,b,a,g){if(!g){g="bwinPopup"}if(!f){f="900px"}if(!b){b="730px"}$("#__blackpopup__").remove();var e=$("<div>").attr("id","__blackpopup__");e.css({position:"fixed",top:0,left:0,width:"100%",height:"100%",textAlign:"center"});if(window.name!=g){e.css({backgroundImage:"url('"+contextPath+"/applications/teamwork/images/black_70.png')"})}e.append("<iframe id='"+g+"' name='"+g+"' frameborder='0'></iframe>");e.bringToFront();e.bind("close",function(){e.slideUp(300,function(){e.remove();if(typeof(a)=="function"){a()}})});e.bind("destroy",function(){e.remove()});e.find("iframe:first").attr("src",d).css({width:f,height:b,top:100,border:"8px solid #909090",backgroundColor:"#ffffff"});var c=$("<div>").css({width:f,position:"relative",height:"5px",textAlign:"right",margin:"auto"});c.append("<img src=\"res/closeBig.png\" style='cursor:pointer;position:absolute;right:-40px;top:30px;'>");c.find("img:first").click(function(){e.trigger("close")});e.prepend(c);$("body").append(e)}function createBlackPage(g,b,a){if(!g){g="900px"}if(!b){b="730px"}$("#__blackpopup__").remove();var f=$("<div>").attr("id","__blackpopup__");f.css({position:"fixed",top:"0px",paddingTop:"50px",left:0,width:"100%",height:"100%",backgroundImage:"url('res/img/black_70.png')"});f.append("<div id='bwinPopupd' name='bwinPopupd'></div>");f.bringToFront();var e=f.find("#bwinPopupd");e.css({width:g,height:b,top:10,"-moz-box-shadow":"1px 1px 6px #333333",overflow:"auto","-webkit-box-shadow":"1px 1px 6px #333333",border:"8px solid #777",backgroundColor:"#fff",margin:"auto"});var d=$("<div>").css({width:g,position:"relative",height:"0px",textAlign:"right",margin:"auto"});var c=$("<img src='res/closeBig.png' style='cursor:pointer;position:absolute;right:-40px;top:5px;' title='close'>");d.append(c);c.click(function(){f.trigger("close")});f.prepend(d);$("body").append(f);f.bind("close",function(){f.slideUp(300,function(){f.remove();if(typeof(a)=="function"){a()}})});f.bind("destroy",function(){f.remove()});return e}function getBlackPopup(){var a=$("#__blackpopup__");if(typeof(top)!="undefined"){a=window.parent.$("#__blackpopup__")}return a}function closeBlackPopup(){getBlackPopup().trigger("close")}function openIssueEditorInBlack(d,c,b){if(!c){c="ED"}var a=contextPath+"/applications/teamwork/issue/issueEditor.jsp?CM="+c+"&OBJID="+d;if(b){a=a+b}openBlackPopup(a,1020,$(window).height()-50,function(){$("#"+d).effect("highlight",{color:"yellow"},1500)})}function openBoardInBlack(e,c,b,d){if(!c){c="ED"}var a=contextPath+"/applications/teamwork/board/boardEditor.jsp?CM="+c+"&OBJID="+e;if(b){a=a+b}openBlackPopup(a,$(window).width()-100,$(window).height()-50,d)};