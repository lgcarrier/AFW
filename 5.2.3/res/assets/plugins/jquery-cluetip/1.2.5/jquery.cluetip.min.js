/*!
 * jQuery clueTip plugin v1.2.5
 *
 * Date: Mon Jan 16 23:33:54 2012 EST
 * Requires: jQuery v1.3+
 *
 * Copyright 2011, Karl Swedberg
 * Dual licensed under the MIT and GPL licenses:
 * http://www.opensource.org/licenses/mit-license.php
 * http://www.gnu.org/licenses/gpl.html
 *
 *
 * Examples can be found at http://plugins.learningjquery.com/cluetip/demo/
 *
*/
(function(e){e.cluetip={version:"1.2.5",template:["<div>",'<div class="cluetip-outer">','<h3 class="cluetip-title ui-widget-header ui-cluetip-header"></h3>','<div class="cluetip-inner ui-widget-content ui-cluetip-content"></div>',"</div>",'<div class="cluetip-extra"></div>','<div class="cluetip-arrows ui-state-default"></div>',"</div>"].join(""),setup:{insertionType:"appendTo",insertionElement:"body"},defaults:{multiple:false,width:275,height:"auto",cluezIndex:97,positionBy:"auto",topOffset:15,leftOffset:15,local:false,localPrefix:null,localIdSuffix:null,hideLocal:true,attribute:"rel",titleAttribute:"title",splitTitle:"",escapeTitle:false,showTitle:true,cluetipClass:"default",hoverClass:"",waitImage:true,cursor:"help",arrows:false,dropShadow:true,dropShadowSteps:6,sticky:false,mouseOutClose:false,activation:"hover",clickThrough:true,tracking:false,delayedClose:0,closePosition:"top",closeText:"Close",truncate:0,fx:{open:"show",openSpeed:""},hoverIntent:{sensitivity:3,interval:50,timeout:0},onActivate:function(g){return true},onShow:function(h,g){},onHide:function(h,g){},ajaxCache:true,ajaxProcess:function(g){g=g.replace(/<(script|style|title)[^<]+<\/(script|style|title)>/gm,"").replace(/<(link|meta)[^>]+>/g,"");return g},ajaxSettings:{dataType:"html"},debug:false}};var f,a="cluetip ui-widget ui-widget-content ui-cluetip",c={},b=0,d=0;e.fn.attrProp=e.fn.prop||e.fn.attr;e.fn.cluetip=function(q,h){var p,i,l,k,o,s;if(typeof q=="object"){h=q;q=null}if(q=="destroy"){var x=this.data("cluetip");if(x){e(x.selector).remove();e.removeData(this,"title");e.removeData(this,"cluetip");e(document).unbind(".cluetip");return this.unbind(".cluetip")}}h=e.extend(true,{},e.cluetip.defaults,h||{});b++;var w,j=e.cluetip.backCompat||!h.multiple?"cluetip":"cluetip-"+b,n="#"+j,r=e.cluetip.backCompat?"#":".",t=e.cluetip.setup.insertionType,v=e.cluetip.setup.insertionElement||"body";t=(/appendTo|prependTo|insertBefore|insertAfter/).test(t)?t:"appendTo";p=e(n);if(!p.length){p=e(e.cluetip.template)[t](v).attr("id",j).css({position:"absolute",display:"none"});w=+h.cluezIndex;l=p.find(r+"cluetip-outer").css({position:"relative",zIndex:w});i=p.find(r+"cluetip-inner");k=p.find(r+"cluetip-title")}f=e("#cluetip-waitimage");if(!f.length){f=e("<div></div>").attr("id","cluetip-waitimage").css({position:"absolute"})}f.insertBefore(p).hide();var u=(parseInt(p.css("paddingLeft"),10)||0)+(parseInt(p.css("paddingRight"),10)||0);this.each(function(U){var F=this,L=e(this),S=e.extend(true,{},h,e.metadata?L.metadata():e.meta?L.data():L.data("cluetip")||{}),A=false,ac=false,ab=0,Q=S[S.attribute]||(S.attribute=="href"?L.attr(S.attribute):L.attrProp(S.attribute)||L.attr(S.attribute)),D=S.cluetipClass;w=+S.cluezIndex;L.data("cluetip",{title:F.title,zIndex:w,selector:n});if(!Q&&!S.splitTitle&&!q){return true}if(S.local&&S.localPrefix){Q=S.localPrefix+Q}if(S.local&&S.hideLocal&&Q){e(Q+":first").hide()}var R=parseInt(S.topOffset,10),N=parseInt(S.leftOffset,10);var M,ad,J=isNaN(parseInt(S.height,10))?"auto":(/\D/g).test(S.height)?S.height:S.height+"px";var y,G,V,ai,X,ae;var K=parseInt(S.width,10)||275,af=K+u+S.dropShadowSteps,O=this.offsetWidth,H,W,aj,Y,z;var aa;var T=(S.attribute!="title")?L.attrProp(S.titleAttribute)||"":"";if(S.splitTitle){aa=T.split(S.splitTitle);T=S.showTitle||aa[0]===""?aa.shift():""}if(S.escapeTitle){T=T.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;")}var C;function ah(){return false}var I=function(ak){var al,aq=S.onActivate(L),at;if(aq===false){return false}ac=true;p=e(n).css({position:"absolute"});l=p.find(r+"cluetip-outer");i=p.find(r+"cluetip-inner");k=p.find(r+"cluetip-title");o=p.find(r+"cluetip-arrows");p.removeClass().css({width:K});if(Q==L.attr("href")){L.css("cursor",S.cursor)}if(S.hoverClass){L.addClass(S.hoverClass)}G=V=L.offset().top;H=L.offset().left;O=L.innerWidth();if(ak.type==focus){Y=H+(O/2)+N;p.css({left:W});X=V+R}else{Y=ak.pageX;X=ak.pageY}if(F.tagName.toLowerCase()!="area"){y=e(document).scrollTop();z=e(window).width()}if(S.positionBy=="fixed"){W=O+H+N;p.css({left:W})}else{W=(O>H&&H>af)||H+O+af+N>z?H-af-N:O+H+N;if(F.tagName.toLowerCase()=="area"||S.positionBy=="mouse"||O+af>z){if(Y+20+af>z){p.addClass("cluetip-"+D);W=(Y-af-N)>=0?Y-af-N-parseInt(p.css("marginLeft"),10)+parseInt(i.css("marginRight"),10):Y-(af/2)}else{W=Y+N}}al=W<0?ak.pageY+R:ak.pageY;if(W<0||S.positionBy=="bottomTop"){W=(Y+(af/2)>z)?z/2-af/2:Math.max(Y-(af/2),0)}}o.css({zIndex:L.data("cluetip").zIndex+1});p.css({left:W,zIndex:L.data("cluetip").zIndex});ad=e(window).height();if(q){if(typeof q=="function"){q=q.call(F)}i.html(q);Z(al)}else{if(aa){var an=aa.length;i.html(an?aa[0]:"");if(an>1){for(var am=1;am<an;am++){i.append('<div class="split-body">'+aa[am]+"</div>")}}Z(al)}else{if(!S.local&&Q.indexOf("#")!==0){if(/\.(jpe?g|tiff?|gif|png)(?:\?.*)?$/i.test(Q)){i.html('<img src="'+Q+'" alt="'+T+'" />');Z(al)}else{var ar=S.ajaxSettings.beforeSend,ao=S.ajaxSettings.error,ap=S.ajaxSettings.success,aw=S.ajaxSettings.complete;var av={cache:S.ajaxCache,url:Q,beforeSend:function(ay,ax){if(ar){ar.call(F,ay,p,i,ax)}l.children().empty();if(S.waitImage){f.css({top:X+20,left:Y+20,zIndex:L.data("cluetip").zIndex-1}).show()}},error:function(ax,ay){if(h.ajaxCache&&!c[Q]){c[Q]={status:"error",textStatus:ay,xhr:ax}}if(ac){if(ao){ao.call(F,ax,ay,p,i)}else{i.html("<i>sorry, the contents could not be loaded</i>")}}},success:function(ax,az,ay){if(h.ajaxCache&&!c[Q]){c[Q]={status:"success",data:ax,textStatus:az,xhr:ay}}A=S.ajaxProcess.call(F,ax);if(typeof A=="object"&&A!==null){T=A.title;A=A.content}if(ac){if(ap){ap.call(F,ax,az,p,i)}i.html(A)}},complete:function(az,aB){if(aw){aw.call(F,az,aB,p,i)}var aA=i[0].getElementsByTagName("img");d=aA.length;for(var ay=0,ax=aA.length;ay<ax;ay++){if(aA[ay].complete){d--}}if(d&&!e.browser.opera){e(aA).bind("load.ct error.ct",function(){d--;if(d===0){f.hide();e(aA).unbind(".ct");if(ac){Z(al)}}})}else{f.hide();if(ac){Z(al)}}}};at=e.extend(true,{},S.ajaxSettings,av);if(c[Q]){E(c[Q],at)}else{e.ajax(at)}}}else{if(S.local){var au=e(Q+(/^#\S+$/.test(Q)?"":":eq("+U+")")).clone(true).show();if(S.localIdSuffix){au.attr("id",au[0].id+S.localIdSuffix)}i.html(au);Z(al)}}}}};var Z=function(an){var al,am,aq,ak=T||S.showTitle&&"&nbsp;",ar="",ap="";p.addClass("cluetip-"+D);if(S.truncate){var ao=i.text().slice(0,S.truncate)+"...";i.html(ao)}if(ak){k.show().html(ak)}else{k.hide()}if(S.sticky){al=e('<div class="cluetip-close"><a href="#">'+S.closeText+"</a></div>");(S.closePosition=="bottom")?al.appendTo(i):(S.closePosition=="title")?al.prependTo(k):al.prependTo(i);al.bind("click.cluetip",function(){P();return false});if(S.mouseOutClose){p.bind("mouseleave.cluetip",function(){P()})}else{p.unbind("mouseleave.cluetip")}}l.css({zIndex:L.data("cluetip").zIndex,overflow:J=="auto"?"visible":"auto",height:J});M=J=="auto"?Math.max(p.outerHeight(),p.height()):parseInt(J,10);ai=V;ae=y+ad;if(S.positionBy=="fixed"){ai=V-S.dropShadowSteps+R}else{if((W<Y&&Math.max(W,0)+af>Y)||S.positionBy=="bottomTop"){if(V+M+R>ae&&X-y>M+R){ai=X-M-R;ap="top"}else{ai=X+R;ap="bottom"}}else{if(V+M+R>ae){ai=(M>=ad)?y:ae-M-R}else{if(L.css("display")=="block"||F.tagName.toLowerCase()=="area"||S.positionBy=="mouse"){ai=an-R}else{ai=V-S.dropShadowSteps}}}}if(ap===""){ap=W<H?"left":"right"}am=" clue-"+ap+"-"+D+" cluetip-"+D;if(D=="rounded"){am+=" ui-corner-all"}p.css({top:ai+"px"}).attrProp({className:a+am});if(S.arrows){if(/(left|right)/.test(ap)){aq=p.height()-o.height();ar=W>=0&&an>0?(V-ai-S.dropShadowSteps):0;ar=aq>ar?ar:aq;ar+="px"}o.css({top:ar}).show()}else{o.hide()}s=m(p,S);if(s&&s.length){s.hide().css({height:M,width:K,zIndex:L.data("cluetip").zIndex-1}).show()}p.hide()[S.fx.open](S.fx.openSpeed||0);if(e.fn.bgiframe){p.bgiframe()}if(S.delayedClose>0){ab=setTimeout(P,S.delayedClose)}S.onShow.call(F,p,i)};var ag=function(ak){ac=false;f.hide();if(!S.sticky||(/click|toggle/).test(S.activation)){P();clearTimeout(ab)}if(S.hoverClass){L.removeClass(S.hoverClass)}};var P=function(aq){var am=aq&&aq.data("cluetip")?aq:L,ao=am.data("cluetip")&&am.data("cluetip").selector,al=ao||"div.cluetip",ap=e(al),ak=ap.find(r+"cluetip-inner"),an=ap.find(r+"cluetip-arrows");ap.hide().removeClass();S.onHide.call(am[0],ap,ak);if(ao){am.removeClass("cluetip-clicked");am.css("cursor","")}if(ao&&T){am.attrProp(S.titleAttribute,T)}if(S.arrows){an.css({top:""})}};e(document).unbind("hideCluetip.cluetip").bind("hideCluetip.cluetip",function(ak){P(e(ak.target))});if((/click|toggle/).test(S.activation)){L.bind("click.cluetip",function(ak){if(p.is(":hidden")||!L.is(".cluetip-clicked")){I(ak);e(".cluetip-clicked").removeClass("cluetip-clicked");L.addClass("cluetip-clicked")}else{ag(ak)}return false})}else{if(S.activation=="focus"){L.bind("focus.cluetip",function(ak){L.attrProp("title","");I(ak)});L.bind("blur.cluetip",function(ak){L.attrProp("title",L.data("cluetip").title);ag(ak)})}else{L[S.clickThrough?"unbind":"bind"]("click.cluetip",ah);var B=function(ak){if(S.tracking){var am=W-ak.pageX;var al=ai?ai-ak.pageY:V-ak.pageY;L.bind("mousemove.cluetip",function(an){p.css({left:an.pageX+am,top:an.pageY+al})})}};if(e.fn.hoverIntent&&S.hoverIntent){L.hoverIntent({sensitivity:S.hoverIntent.sensitivity,interval:S.hoverIntent.interval,over:function(ak){I(ak);B(ak)},timeout:S.hoverIntent.timeout,out:function(ak){ag(ak);L.unbind("mousemove.cluetip")}})}else{L.bind("mouseenter.cluetip",function(ak){I(ak);B(ak)}).bind("mouseleave.cluetip",function(ak){ag(ak);L.unbind("mousemove.cluetip")})}L.bind("mouseover.cluetip",function(ak){L.attrProp("title","")}).bind("mouseleave.cluetip",function(ak){L.attrProp("title",L.data("cluetip").title)})}}function E(am,al){var ak=am.status;al.beforeSend(am.xhr,al);if(ak=="error"){al[ak](am.xhr,am.textStatus)}else{if(ak=="success"){al[ak](am.data,am.textStatus,am.xhr)}}al.complete(am.xhr,al.textStatus)}});function g(){}function m(D,G,F){var y="",z=(G.dropShadow&&G.dropShadowSteps)?+G.dropShadowSteps:0;if(e.support.boxShadow){if(z){y="1px 1px "+z+"px rgba(0,0,0,0.5)"}var B=z===0?"0 0 ":"1px 1px ";D.css(e.support.boxShadow,y);return false}var C=D.find(".cluetip-drop-shadow");if(z==C.length){return C}C.remove();var E=[];for(var A=0;A<z;){E[A++]='<div style="top:'+A+"px;left:"+A+'px;"></div>'}F=e(E.join("")).css({position:"absolute",backgroundColor:"#000",zIndex:w-1,opacity:0.1}).addClass("cluetip-drop-shadow").prependTo(D);return F}return this};(function(){e.support=e.support||{};var g=document.createElement("div"),k=g.style,r=["boxShadow"],p=["moz","Moz","webkit","o"];for(var q=0,m=r.length;q<m;q++){var h=r[q],l=h.charAt(0).toUpperCase()+h.slice(1);if(typeof k[h]!=="undefined"){e.support[h]=h}else{for(var o=0,n=p.length;o<n;o++){if(typeof k[p[o]+l]!=="undefined"){e.support[h]=p[o]+l;break}}}}g=null})();e.fn.cluetip.defaults=e.cluetip.defaults})(jQuery);