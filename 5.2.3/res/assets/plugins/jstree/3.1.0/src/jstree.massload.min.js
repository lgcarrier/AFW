(function(a){if(typeof define==="function"&&define.amd){define("jstree.massload",["jquery","jstree"],a)}else{if(typeof exports==="object"){a(require("jquery"),require("jstree"))}else{a(jQuery,jQuery.jstree)}}}(function(b,a,c){if(b.jstree.plugins.massload){return}b.jstree.defaults.massload=null;b.jstree.plugins.massload=function(d,e){this.init=function(g,f){e.init.call(this,g,f);this._data.massload={}};this._load_nodes=function(f,i,g){var h=this.settings.massload;if(g&&!b.isEmptyObject(this._data.massload)){return e._load_nodes.call(this,f,i,g)}if(b.isFunction(h)){return h.call(this,f,b.proxy(function(k){if(k){for(var j in k){if(k.hasOwnProperty(j)){this._data.massload[j]=k[j]}}}e._load_nodes.call(this,f,i,g)},this))}if(typeof h==="object"&&h&&h.url){h=b.extend(true,{},h);if(b.isFunction(h.url)){h.url=h.url.call(this,f)}if(b.isFunction(h.data)){h.data=h.data.call(this,f)}return b.ajax(h).done(b.proxy(function(m,l,j){if(m){for(var k in m){if(m.hasOwnProperty(k)){this._data.massload[k]=m[k]}}}e._load_nodes.call(this,f,i,g)},this)).fail(b.proxy(function(j){e._load_nodes.call(this,f,i,g)},this))}return e._load_nodes.call(this,f,i,g)};this._load_node=function(f,h){var g=this._data.massload[f.id];if(g){return this[typeof g==="string"?"_append_html_data":"_append_json_data"](f,typeof g==="string"?b(b.parseHTML(g)).filter(function(){return this.nodeType!==3}):g,function(i){h.call(this,i);delete this._data.massload[f.id]})}return e._load_node.call(this,f,h)}}}));